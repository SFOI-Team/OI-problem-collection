- 题目名：Flash memory
- 来源：
  - 竞赛：BalticOI
  - 年份：2019
  - 比赛日：Day 1
  - 编号：T1
- 时间限制：1000 ms
- 空间限制：1024 MiB
- 类型：通信

## 题目描述

一块芯片有 $B$ 位的内存，我们需要在其中存储一个 $M$ 位的变量。内存有一个缺陷，一个位可以从 $0$ 更改为 $1$，但要将 $1$ 更改为 $0$ 需要将整个内存清空。因为芯片寿命有限，只能清空有限次的内存。我们的目标是在清空内存前，写入尽可能多的值。

你的任务是设计一种将值存储到内存的有效方案，以便始终可以检索当前值。具体来说，你的程序需要实现这两种操作：

- 写入一个值：程序将读入存储器的当前状态和要写入的新值，你需要输出存储器在写入值后的新状态。
- 读取一个值：程序将读入经过一定数量写操作后的内存状态，你需要输出在上一次写入操作中写入的值。

除了从输入中读取内存的当前状态，以及在把新状态写入输出前将某些位（可能是零个位）上的值从 $0$ 更改为 $1$ 之外，你的读取操作和写入操作之间无法进行任何信息交换。

## 通信要求

本题是一道通信题。你需要写一个程序来完成题目要求的任务。

程序启动时，输入的第一行包含一个整数 $T$，$T=0$ 表示你的程序需要将值写入内存，而 $T=1$ 则表示你的程序需要从内存中读取值。

第二行包含两个整数 $B,M$，意义见「题目描述」。

对于每个操作，第一行包含一个整数 $C$，当 $C=0$ 时将不再有读取或写入操作，你的程序应该退出；而 $C=1$ 时你的程序需要继续处理。

- 对于写入操作（$T=0$）：第二行包含两个以空格分隔的字符串，分别为内存的当前状态（$B$ 位的序列）和要写入的新值（$M$ 位的序列）。如果你的程序可以通过仅将某些位从 $0$ 变为 $1$ 来将新值写入内存，你的程序需要输出一个整数 $1$，然后在下一行输出一个 $B$ 位字符串，代表写入后内存的状态。如果你的程序无法将新值写入内存，输出一个整数 $0$。
- 对于读取操作（$T=1$）：第二行包含一个字符串，代表内存的当前状态。你的出现需要输出一个 $M$ 位字符串，代表最近一次向内存写入的值。

## 样例

### 样例输入 1

```plain
0
6 2
1
111111 00
1
000000 11
0
```

### 样例输出 1

```plain
0
1
110000
```

### 样例解释 1

这是一个向程序中写入数据的例子。

第一次写入无法实现，因此程序输出 $0$，而第二次写入是可以实现的。

请注意，第二次尝试写入时的内存状态和第一次写入后的内存状态并不匹配（详见「评测方式」）。

### 样例输入 2

```plain
1
6 2
1
110000
1
110100
0
```

### 样例输出 2

```plain
11
01
```

### 样例解释 2

这是一个从内存中读取数据的例子。

## 评测方式

对于每个测试数据，将同时启动你的程序的 $4$ 个实例，其中 $2$ 个用于写入，另外 $2$ 个用于读取。所有实例的时间之和以及空间之和，将被视为你的程序在该测试点上的实际使用时间和空间。**任何试图通过其他渠道在实例之间传输信息的行为将被视为作弊，并将被取消参赛资格**。

若干个长度为 $K$ 的内存，将全部初始化为零。随后以某种可行的顺序执行读取和写入操作。

在写入操作期间，将为写入程序实例提供其中一个内存的当前状态以及要写入的值。你可以假定要写入的值从 $[0,2^M-1]$ 中均匀随机选取，且与其他因素无关。如果你的程序能向该内存写入值，则该内存的状态将被更新为写入后的状态，否则，该内存将不再参与进一步的写入操作。

在读取操作期间，写入操作成功执行后，将为读取程序实例提供某个内存的状态。检查器将会检查你程序返回的值与实际写入的值是否一致。每个内存在执行一次写入操作后，仅会执行恰好一次读取操作。

## 评分方式

对于每个测试数据集，程序的得分将与该测试集中写入的数的平均数成正比。具体来说，如果你的程序对于每个内存平均执行了 $V$ 次写入操作，你的得分占测试集满分的百分比将是 $100 \cdot V/P\%$，其中 $P$ 的值将会在下面给出。

如果你的程序在读取操作时给出了错误的结果，则你的程序在**该测试数据集**上得零分。

如果你的程序遇到了其他问题，则你的程序在**该测试点**上的成功读取次数记为零次。

比赛期间，你的程序将仅在每个测试数据集的若干个测试点上运行。比赛结束后，你的最后一个提交以及你得分最高（比赛期间的得分）的提交将在完整测试数据集上进行测试。两者得分较高者将作为你在该题上的最终得分。

## 数据范围

本题有 $20$ 个测试数据集，每个数据集均为 $5$ 分。

所有测试点均满足 $N \times B \leq 120\,000$，其中 $N$ 为你的程序最多执行的写入操作的次数。

| 测试集编号 | $B=$ | $M=$ | $P=$                      |
| ---------- | ---- | ---- | ------------------------- |
| 1          | 16   | 8    | 4.062445024495069624056   |
| 2          | 32   | 8    | 12.264904841300964834177  |
| 3          | 32   | 16   | 4.129591513707784802006   |
| 4          | 64   | 8    | 30.039277894268828900030  |
| 5          | 64   | 16   | 12.953148094217360432715  |
| 6          | 64   | 32   | 4.073559788233661501537   |
| 7          | 128  | 8    | 69.777892228928747548775  |
| 8          | 128  | 16   | 34.731791275143635240976  |
| 9          | 128  | 32   | 13.950788987705638908663  |
| 10         | 128  | 64   | 4.039918210604800133907   |
| 11         | 256  | 8    | 174.468047086071038511453 |
| 12         | 256  | 16   | 82.222614151404177334554  |
| 13         | 256  | 32   | 37.629382269769206488916  |
| 14         | 256  | 64   | 14.263462282054140577686  |
| 15         | 256  | 128  | 4.015569093893943430859   |
| 16         | 512  | 16   | 204.746242127410346170221 |
| 17         | 512  | 32   | 91.778595148073111539847  |
| 18         | 512  | 64   | 39.230279242145938712621  |
| 19         | 512  | 128  | 15.000000002167672268601  |
| 20         | 512  | 256  | 4.005423277111055468876   |

