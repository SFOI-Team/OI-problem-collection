- 题目名：Delightful
- 来源：
  - 竞赛：IPSC
  - 年份：2018
  - 编号：D

你在你奶奶家的地下室里找到了一个奇怪的盒子，仔细观察后发现是一台老式计算机。你试图在这台计算机上运行几个程序，但发现程序的行为非常奇怪。你花了好一段时间才发现原因：这台计算机采用三进制！

一个三进制位可以存储 0，1，2 三种数值。当我们进行三进制逻辑运算时，我们用 0 表示假，1 表示未知，2 表示真。

这台电脑有 26 个寄存器，分别标号为 A 到 Z。每个寄存器存储一个**40-三进制位**无符号整数型变量。

## 运算

这台计算机支持如下算术运算符：+，-，*，/（整除），%（取模）。所有运算均在模 $3^{40}$ 意义下进行。除零和对零取模将会触发运行时错误。

这台计算机还支持如下三进制逻辑运算符：

- &（按位与）
  - 当参与运算的两个三进制位有一位为假（0）时返回假（0）；
  - 当参与运算的两个三进制位均为真（2）时返回真（2）；
  - 否则返回未知（1）。
- |（按位或）
  - 当参与运算的两个三进制位有一位为真（2）时返回真（2）；
  - 当参与运算的两个三进制位均为假（0）时返回假（0）；
  - 否则返回未知（1）。
- ^（异或）可以认为是两个三进制位相加后对 3 取模的结果。
- ~（取反）可以认为是 2 - 该位值 的结果。
- <<（左移）和 >>（右移）与二进制意义下的移位操作相同，多出的位将会补 0。

这里是几个例子（下面用 $\oplus$ 代替了 ^）：

- $210_3 \& 111_3 = 110_3$
- $210_3 | 111_3 = 211_3$
- $210_3 \oplus 111_3 = 021_3$
- ~$210_3 = 222\ldots 222012_3$（在 012 前有 37 个连续的 2）
- $210_3$ << $2 = 21000_3$
- $210_3$ >> $2 = 2_3$ 

## 程序

你怀疑这台计算机存在循环和跳转的指令，但你现在还没有发现这些指令。这意味着，在这个问题中，你不得不做一些额外的工作。

在本问题中，程序是有限的指令序列，每条指令将按给定的顺序执行一次。每个指令都满足如下三条形式之一：

- `[register] = [operand]`
- `[register] = [operand] [operator-with-two-operands] [operand]`
- `[register] = [operator-with-one-operand] [operand]`

其中，运算符是上文列出的运算符，而 `[operand]` 则可能是寄存器变量或是一个能存储在寄存器内的整型常数。

常数将会以十进制或三进制的形式给出。十进制常数没有任何前缀，三进制常数将会有前缀 `0t` （数字 0 和小写字母 t）。例如， 47 和 0t001202 代表同样的数字。

相邻两个 token 之间必须添加至少一个空格。

## 示例

在下面的程序开始执行时，寄存器 X 存储了输入数据，其他寄存器的值为零。我们想要找到 X 的最后一个非零位并将其设置为零。

一个可能的程序如下所示：

```plain
A = X - 1
B = ~ A
C = B ^ X
X = X & C
```

## 子任务 D1

实现一个计算一个数字的最长不下降前缀的程序。例如，对于数字 $x=000122012 \ldots _3$ ，它的最长不下降前缀的值为 6。

形式化的说，我们令 $x$ 的三进制表示为 $x_{39} x_{38} \ldots x_0$，我们定义 $ndp(x)$ 的值为满足条件 $x_{39} \le x_{38} \le \ldots \le x_{39-i+1}$ 的最大整数 $i$ 。

在你的程序开始运行时，寄存器 X 将存储输入数据，其他寄存器的值为零。在你的程序结束运行时，寄存器 Y 必须存储 $ndp(x)$ 的值，其他寄存器的值任意。

**你的程序的指令数不得超过 100 行**。

## 子任务 D2

在你的程序开始时，寄存器 X 将存储输入数据，其他寄存器的值为零。我们保证 $ 0 \le X \le 10^9$。

实现一个程序，当 X 为质数时将 Y 的值设为 1，否则将 Y 的值设为 0。

请注意，0 和 1 不是质数。

**你的程序的指令数不得超过 5000 行**。

## 输入格式

本题没有输入。

## 输出格式

你需要提交符合上述规范并能解决给定子任务的程序。

请注意：

1. 程序中的空行和多余的空格将会被忽略，你可以随意使用空行和空格来改善程序的可读性。
2. 非空行才会计入程序指令总数。
3. 程序中的任意两个 token 之间必须至少有一个空格，任意两个指令之间必须至少用一个换行符隔开。

## 如何测试你的程序

可以在 [这个网站](http://foja.dcs.fmph.uniba.sk/trits/) 上测试你的程序。程序开始运行时，所有寄存器的值将会被设置为零，最多 5000 条命令将会被执行。

如果程序发生错误，将会报告详细错误信息。否则将会报告执行的命令数以及所有寄存器最终的值为多少。